Version longue de l'entretien avec `Najda Villefranque <mailto:najda.villefranque@meteo.fr>`_ (CNRM)
************************************************************************************

.. image:: photo_nv.jpg
  :width: 250

Najda, tu as développé un simulateur de rayonnement 3D qui peut être appliqué à des champs 3D issus de simulations Méso-NH. Pourrais-tu résumer ce que fait ce logiciel ?
  Le logiciel `htrdr <https://www.meso-star.com/projects/htrdr/htrdr.html>`_ est un code basé sur les méthodes de Monte Carlo qui simule la trajectoire d'un grand nombre de photons pour résoudre le transfert radiatif atmosphérique. Il prend en entrée une description 3D de l'atmosphère, typiquement des sorties de simulations Méso-NH, ainsi qu'une description des surfaces (par exemple d'une ville comme `ici <https://web.lmd.jussieu.fr/~nvillefranque/pages/teapot_city>`_ mais on peut évidemment aussi prescrire une surface plane). Les photons interagissent avec les hydrométéores, les aérosols, les gaz et les surfaces au travers de phénomènes d'absorption / émission et de diffusion / réflexion. La répartition des photons sur les capteurs virtuels positionnés dans la scène par l'utilisateur.trice donne une estimation de l'intensité du rayonnement sur ces capteurs.

Pour quelles applications conseilles-tu d'utiliser htrdr ?
  htrdr est un logiciel de calcul de référence, donc je conseille son utilisation à chaque fois qu'il y a besoin de connaître avec précision une grandeur radiative, que ce soit solaire (SW) ou thermique (LW), sous forme de carte ou intégrée horizontalement. Cela peut par exemple servir à estimer l'effet radiatif des nuages ou des aérosols simulés, à étudier la façon dont ils impactent le rayonnement en fonction de leurs propriétés, ou à évaluer et améliorer les paramétrisations des modèles de grande échelle qui ne voient pas tout le détail du champ et font des approximations sur la modélisation du transfert radiatif. Les calculs radiatifs de référence peuvent également servir de cible lors de la calibration des paramétrisations dans les modèles de grande échelle pour des cas idéalisés, pour lesquels on ne dispose pas d'observations. Sur cet aspect "référence", on pourrait dire que htrdr est au rayonnement ce que Meso-NH est à la dynamique atmosphérique ! 

  htrdr permet également de produire des images de synthèse. Les mêmes techniques de simulation sont utilisées par Disney pour produire leurs films, même s'ils sont en retard sur nous car ils n'utilisent pas encore Méso-NH pour simuler des nuages réalistes (rire). Ces simulations permettent de visualiser un champ 3D issu de Méso-NH sous forme de photo, ou une séquence temporelle sous forme de film, ou encore de synthétiser des images de type satellite, utiles pour concevoir ou évaluer les algorithmes d'inversion.

Pourquoi vaut-il mieux utiliser htrdr plutôt que d'autres programmes équivalents ? 
  Les avantages des méthodes de Monte Carlo en général sont leur précision (prise en compte de processus détaillés, absence de biais), leur flexibilité (notamment sur les domaines d'intégration spatiaux et spectraux) et leur insensibilité théorique à la complexité des scènes virtuelles dans lesquelles les photons se propagent. Entre spécialistes du domaine, on dit souvent que si on sait résoudre un problème par Monte Carlo dans un cube, alors on sait le résoudre dans une géométrie complexe (comme une ville ou un stade). Pourtant, cette insensibilité théorique est rarement vérifiée en pratique, pour des questions informatiques : gestion de la donnée (il faut beaucoup plus d'information pour décrire une ville qu'un cube) et traitement de cette donnée par les algorithmes d'intersection entre le photon et les surfaces (il faut trouver l'endroit où le photon touche la surface et c'est d'autant plus long que la donnée décrivant cette surface est massive). Or, la communauté de recherche en informatique graphique a produit des outils qui ont permis de rendre effective cette insensibilité à la complexité des scènes. Contrairement aux autres codes Monte Carlo existant en sciences de l'atmosphère, htrdr utilise ces outils et les étend aux données volumiques |villefranque_etal|. Ainsi, le temps de calcul, s'il reste beaucoup plus long que pour un calcul approché de type "deux-flux", ne dépend pas de la quantité de données à ingérer ; le calcul radiatif prenant en entrée une sortie de Méso-NH à 5 m de résolution au-dessus d'un relief détaillé ne sera pas plus long que pour une sortie à 500 m sur un sol plat, à taille de domaine fixée. Un autre avantage de htrdr est que c'est un logiciel vivant, en développement continu au sein de notre communauté et également utilisé et enrichi dans d'autres communautés comme la planétologie par exemple.

Quelles recommandations ferais-tu aux utilisateurs.trices ?
  Je leur recommanderais de ne pas hésiter à me contacter (ou Robert Schoetter qui est aussi un expert de htrdr !) si ils et elles souhaitent prendre en main ce logiciel. Il y a de la `documentation <https://www.meso-star.com/projects/htrdr/man/man1/htrdr-atmosphere.1.html>`_ et du `matériel de formation <https://mattermost.lmd.ipsl.fr/g3t-rayonnement/channels/htrdr>`_ disponibles en ligne pour une prise en main autonome, mais à mon avis c'est mieux de discuter en amont pour s'assurer que le logiciel est bien adapté aux besoins. Je peux ensuite aider à choisir les configurations / options, vous guider pour les entrées / sorties etc. C'est aussi tout simplement l'occasion de parler de physique du rayonnement, et ce même si la question scientifique qui motive la simulation n'est pas directement liée au transfert radiatif, par exemple pour un besoin de visualisation. N'hésitez pas, parce qu'en vrai, le rayonnement, c'est vachement plus fun que ce qu'on pense (rire) !

Quelles sont les limites ?
  Comparé à d'autres méthodes moins précises, le temps de calcul peut être limitant en présence de nuages très diffusants. Même si pour les utilisateurs.trices de Méso-NH qui ont l'habitude de lancer des grosses simulations ça n'est probablement pas techniquement limitant, c'est bien d'avoir conscience que ça consomme pas mal d'énergie. Pensez dans une première phase de réglage qu'on peut faire des simulations moins gourmandes en simulant un petit nombre de photons - l'estimation sera bruitée (par l'incertitude statistique) mais donnera une première idée du résultat de la simulation qui a été lancée - l'équivalent de lancer une première simulation Méso-NH sur petit domaine ou à résolution dégradée pour s'assurer que le modèle est bien réglé avant de lancer une Giga-LES ! Il y a aussi des limites sur la modélisation physique du transfert, par exemple la fonction de phase de diffusion des hydrométéores et aérosols est une approximation par rapport à ce que prédit la théorie de Mie ; ce n'est pas du tout indépassable mais il faudra investir du temps de recherche et de développement pour s'affranchir de cette approximation, si besoin. Autre exemple, à ce jour les capteurs virtuels sont définis comme des surfaces planes donc on ne peut pas estimer le flux radiatif intégré sur la surface d'une montagne par exemple. De la même façon, il existe des propositions pour inclure cette fonctionnalité (déjà implémentées dans htrdr-urban par Robert), il n'y a "plus qu'à" l'introduire dans la version standard du logiciel, quand le besoin sera là. En résumé, htrdr est un outil puissant, qui peut être déjà très utile, qui évidemment ne peut pas tout faire, et dans lequel on peut tout à fait développer de nouvelles fonctionnalités pour répondre à de nouveaux besoins. Pour finir, je noterais qu'à ce jour htrdr est un logiciel qui sert essentiellement de diagnostic, à utiliser en "offline" sur des sorties de simulations réalisées par ailleurs avec ou sans rayonnement. Une des perspectives de mes recherches est de coupler htrdr à Meso-NH pour pouvoir faire des simulations atmosphériques incluant une résolution 3D du rayonnement.


.. |villefranque_etal| raw:: html

   <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2018MS001602" target="_blank">(Villefranque et al., 2019)</a>
